\documentclass[a4paper,11pt]{report}

\input{../../../latex_template/preamble}
\input{../../../latex_template/macros}
\input{../../../latex_template/letterfonts}
\usepackage{float}
\usetikzlibrary{calc,arrows,decorations.markings}

\begin{document}
\begin{center}
  {\bf\small Universtiy of Queensland \\ School of Mathematics and Physics}
\end{center}
\begin{center}
	{\Large\bf MATH2302 Discrete Mathematics II \\ Semester 2 2025 \\ Problem Set 4} \\ \vspace{1em}
	Michael Kasumagic, 44302669 \\
  Applied Class \#1 \\
	Due 3pm Friday 28 October 2025
\end{center}

\qs{6 marks}{
  For each of the graphs shown below, determine whether it is Hamiltonian. Justify your answer. 

  \vspace{0.5cm}
  \begin{minipage}{0.48\textwidth}\centering
  % ---------- FIRST TIKZ ----------
  \begin{tikzpicture}[
      scale=1,
      dot/.style={circle,fill,inner sep=1.5pt},
      edge/.style={line width=0.9pt}
  ]

  % radii
  \pgfmathsetmacro{\Rout}{1.0}
  \pgfmathsetmacro{\Rin}{0.45}

  % angles (top vertex at 90째, 72째 apart)
  \foreach \k in {0,...,4}{
    \pgfmathsetmacro{\ang}{90 - 72*\k}
    \coordinate (O\k) at ({\Rout*cos(\ang)},{\Rout*sin(\ang)});
    \coordinate (I\k) at ({\Rin*cos(\ang)},{\Rin*sin(\ang)});
  }

  \coordinate (O) at (0,0);
  % --- Draw outer and inner pentagons ---
  \draw[edge] (O0)--(O1)--(O2)--(O3)--(O4)--cycle;
  %\draw[edge] (I0)--(I1)--(I2)--(I3)--(I4)--cycle;

  % --- Connect corresponding vertices ---
  \foreach \k in {0,...,4}{
    \draw[edge] (O)--(I\k);
  }

  % --- Dots at vertices ---
  \foreach \P in {O0,O1,O2,O3,O4,I0,I1,I2,I3,I4}
    \node[dot] at (\P) {};

  \node [dot] at (O) {};

  \node at (-1.5,0) {(a)};

  \draw[edge] (O0)--(I4) (O0)--(I1) (O2)--(I1) (O3)--(I4) (O2)--(I3) (O3)--(I2) (O1)--(I0) (O1)--(I2) (O4)--(I0) (O4)--(I3);


  \end{tikzpicture}
  \end{minipage}\hfill
  \begin{minipage}{0.48\textwidth}\centering
  % ---------- SECOND TIKZ ----------
  \begin{tikzpicture}[
      scale=1,
      dot/.style={circle,fill,inner sep=1.5pt},
      edge/.style={line width=0.9pt}
  ]
  \pgfmathsetmacro{\s}{0.866025403784}
  \pgfmathsetmacro{\m}{0.65}
  \pgfmathsetmacro{\r}{0.30}

  \coordinate (O1) at (1,0);
  \coordinate (O2) at (0.5,\s);
  \coordinate (O3) at (-0.5,\s);
  \coordinate (O4) at (-1,0);
  \coordinate (O5) at (-0.5,-\s);
  \coordinate (O6) at (0.5,-\s);

  \coordinate (M1) at (\m*1,\m*0);
  \coordinate (M2) at (\m*0.5,\m*\s);
  \coordinate (M3) at (\m*-0.5,\m*\s);
  \coordinate (M4) at (\m*-1,\m*0);
  \coordinate (M5) at (\m*-0.5,\m*-\s);
  \coordinate (M6) at (\m*0.5,\m*-\s);

  \coordinate (I1) at (\r*1,\r*0);
  \coordinate (I2) at (\r*0.5,\r*\s);
  \coordinate (I3) at (\r*-0.5,\r*\s);
  \coordinate (I4) at (\r*-1,\r*0);
  \coordinate (I5) at (\r*-0.5,\r*-\s);
  \coordinate (I6) at (\r*0.5,\r*-\s);

  \draw[edge] (O1)--(O2)--(O3)--(O4)--(O5)--(O6)--cycle;
  \draw[edge] (M1)--(M2)--(M3)--(M4)--(M5)--(M6)--cycle;
  \draw[edge] (I1)--(I2)--(I3)--(I4)--(I5)--(I6)--cycle;

  \draw[edge] (O1)--(I1) (O2)--(I2) (O3)--(I3)
              (O4)--(I4) (O5)--(I5) (O6)--(I6);

  \foreach \P in {O1,O2,O3,O4,O5,O6,M1,M2,M3,M4,M5,M6,I1,I2,I3,I4,I5,I6}
    \node[dot] at (\P) {};

  % midpoints on middle edges 
  \coordinate (Mm12) at ($(M1)!0.5!(M2)$);
  \coordinate (Mm23) at ($(M2)!0.5!(M3)$);
  \coordinate (Mm34) at ($(M3)!0.5!(M4)$);
  \coordinate (Mm45) at ($(M4)!0.5!(M5)$);
  \coordinate (Mm56) at ($(M5)!0.5!(M6)$);
  \coordinate (Mm61) at ($(M6)!0.5!(M1)$);
  \foreach \Q in {Mm12,Mm23,Mm34,Mm45,Mm56,Mm61} \node[dot] at (\Q) {};

  \node at (-1.5,0) {(b)};
  \end{tikzpicture}
  \end{minipage}
}
\sol \vspace{0.5em}

Graph (a) is Hamiltonian. I present one such spanning cycle:

\begin{center}\begin{tikzpicture}[
      scale=2,
      dot/.style={circle,fill,inner sep=1.5pt},
      edge/.style={line width=0.9pt}
  ]

  % radii
  \pgfmathsetmacro{\Rout}{1.0}
  \pgfmathsetmacro{\Rin}{0.45}

  % angles (top vertex at 90째, 72째 apart)
  \foreach \k in {0,...,4}{
    \pgfmathsetmacro{\ang}{90 - 72*\k}
    \coordinate (O\k) at ({\Rout*cos(\ang)},{\Rout*sin(\ang)});
    \coordinate (I\k) at ({\Rin*cos(\ang)},{\Rin*sin(\ang)});
  }

  \coordinate (O) at (0,0);
  % --- Draw outer and inner pentagons ---
  \draw[edge] (O0)--(O1)--(O2)--(O3)--(O4)--cycle;
  %\draw[edge] (I0)--(I1)--(I2)--(I3)--(I4)--cycle;

  % --- Connect corresponding vertices ---
  \foreach \k in {0,...,4}{
    \draw[edge] (O)--(I\k);
  }

  % --- Dots at vertices ---
  \foreach \P in {O0,O1,O2,O3,O4,I0,I1,I2,I3,I4}
    \node[dot] at (\P) {};

  \node [dot] at (O) {};

  \draw[edge] (O0)--(I4) (O0)--(I1) (O2)--(I1) (O3)--(I4) (O2)--(I3) (O3)--(I2) (O1)--(I0) (O1)--(I2) (O4)--(I0) (O4)--(I3);

  \draw[->, red, ultra thick] (O) -- (I0);
  \draw[->, red, ultra thick] (I0) -- (O1);
  \draw[->, red, ultra thick] (O1) -- (I2);
  \draw[->, red, ultra thick] (I2) -- (O3);
  \draw[->, red, ultra thick] (O3) -- (I4);
  \draw[->, red, ultra thick] (I4) -- (O0);
  \draw[->, red, ultra thick] (O0) -- (O4);
  \draw[->, red, ultra thick] (O4) -- (I3);
  \draw[->, red, ultra thick] (I3) -- (O2);
  \draw[->, red, ultra thick] (O2) -- (I1);
  \draw[->, red, ultra thick] (I1) -- (O);

\end{tikzpicture}\end{center}

Graph (b) is not Hamiltonian. We show this by considering Theorem 26.85. Consider the set $S$, which contains only the highlighted vertices. Then consider the graph $G-S$, in particular, we count the number of components the graph has.

\begin{center}\begin{tikzpicture}[
      scale=2,
      dot/.style={circle,fill,inner sep=1.5pt},
      highlightDot/.style={circle,fill,inner sep=2.5pt},
      edge/.style={line width=0.9pt}
  ]
  \pgfmathsetmacro{\s}{0.866025403784}
  \pgfmathsetmacro{\m}{0.65}
  \pgfmathsetmacro{\r}{0.30}

  \coordinate (O1) at (1,0);
  \coordinate (O2) at (0.5,\s);
  \coordinate (O3) at (-0.5,\s);
  \coordinate (O4) at (-1,0);
  \coordinate (O5) at (-0.5,-\s);
  \coordinate (O6) at (0.5,-\s);

  \coordinate (M1) at (\m*1,\m*0);
  \coordinate (M2) at (\m*0.5,\m*\s);
  \coordinate (M3) at (\m*-0.5,\m*\s);
  \coordinate (M4) at (\m*-1,\m*0);
  \coordinate (M5) at (\m*-0.5,\m*-\s);
  \coordinate (M6) at (\m*0.5,\m*-\s);

  \coordinate (I1) at (\r*1,\r*0);
  \coordinate (I2) at (\r*0.5,\r*\s);
  \coordinate (I3) at (\r*-0.5,\r*\s);
  \coordinate (I4) at (\r*-1,\r*0);
  \coordinate (I5) at (\r*-0.5,\r*-\s);
  \coordinate (I6) at (\r*0.5,\r*-\s);

  \draw[edge] (O1)--(O2)--(O3)--(O4)--(O5)--(O6)--cycle;
  \draw[edge] (M1)--(M2)--(M3)--(M4)--(M5)--(M6)--cycle;
  \draw[edge] (I1)--(I2)--(I3)--(I4)--(I5)--(I6)--cycle;

  \draw[edge] (O1)--(I1) (O2)--(I2) (O3)--(I3)
              (O4)--(I4) (O5)--(I5) (O6)--(I6);


  \foreach \P in {O1,O2,O3,O4,O5,O6} \node[dot] at (\P) {};
  \foreach \P in {M1,M2,M3,M4,M5,M6} \node[highlightDot, red] at (\P) {};
  \foreach \P in {I1,I2,I3,I4,I5,I6} \node[dot] at (\P) {};

  % midpoints on middle edges 
  \coordinate (Mm12) at ($(M1)!0.5!(M2)$);
  \coordinate (Mm23) at ($(M2)!0.5!(M3)$);
  \coordinate (Mm34) at ($(M3)!0.5!(M4)$);
  \coordinate (Mm45) at ($(M4)!0.5!(M5)$);
  \coordinate (Mm56) at ($(M5)!0.5!(M6)$);
  \coordinate (Mm61) at ($(M6)!0.5!(M1)$);
  \foreach \Q in {Mm12,Mm23,Mm34,Mm45,Mm56,Mm61} \node[dot] at (\Q) {};

\end{tikzpicture}
\hspace{8em}
\begin{tikzpicture}[
      scale=2,
      dot/.style={circle,fill,inner sep=1.5pt},
      edge/.style={line width=0.9pt}
  ]
  \pgfmathsetmacro{\s}{0.866025403784}
  \pgfmathsetmacro{\m}{0.65}
  \pgfmathsetmacro{\r}{0.30}

  \coordinate (O1) at (1,0);
  \coordinate (O2) at (0.5,\s);
  \coordinate (O3) at (-0.5,\s);
  \coordinate (O4) at (-1,0);
  \coordinate (O5) at (-0.5,-\s);
  \coordinate (O6) at (0.5,-\s);

  \coordinate (M1) at (\m*1,\m*0);
  \coordinate (M2) at (\m*0.5,\m*\s);
  \coordinate (M3) at (\m*-0.5,\m*\s);
  \coordinate (M4) at (\m*-1,\m*0);
  \coordinate (M5) at (\m*-0.5,\m*-\s);
  \coordinate (M6) at (\m*0.5,\m*-\s);

  \coordinate (I1) at (\r*1,\r*0);
  \coordinate (I2) at (\r*0.5,\r*\s);
  \coordinate (I3) at (\r*-0.5,\r*\s);
  \coordinate (I4) at (\r*-1,\r*0);
  \coordinate (I5) at (\r*-0.5,\r*-\s);
  \coordinate (I6) at (\r*0.5,\r*-\s);

  \draw[edge] (O1)--(O2)--(O3)--(O4)--(O5)--(O6)--cycle;
  \draw[edge] (I1)--(I2)--(I3)--(I4)--(I5)--(I6)--cycle;

  \foreach \P in {O1,O2,O3,O4,O5,O6} \node[dot] at (\P) {};
  \foreach \P in {I1,I2,I3,I4,I5,I6} \node[dot] at (\P) {};

  % midpoints on middle edges 
  \coordinate (Mm12) at ($(M1)!0.5!(M2)$);
  \coordinate (Mm23) at ($(M2)!0.5!(M3)$);
  \coordinate (Mm34) at ($(M3)!0.5!(M4)$);
  \coordinate (Mm45) at ($(M4)!0.5!(M5)$);
  \coordinate (Mm56) at ($(M5)!0.5!(M6)$);
  \coordinate (Mm61) at ($(M6)!0.5!(M1)$);
  \foreach \Q in {Mm12,Mm23,Mm34,Mm45,Mm56,Mm61} \node[dot] at (\Q) {};

  \node[left] at (O1) {(1)};
  \node[left] at (I1) {(2)};
  \node[above] at (Mm23) {(3)};
  \node[above] at (Mm12) {(4)};
  \node[above] at (Mm61) {(5)};
  \node[above] at (Mm56) {(6)};
  \node[above] at (Mm45) {(7)};
  \node[above] at (Mm34) {(8)};

\end{tikzpicture}\end{center}
We highlighted 6 vertices for $S\subseteq G$, hence $\abs{S}=6$. The graph $G-S$, has componets: the outer ring, the inner ring, and the 6 isolated vertices. Hence, $\abs{\operatorname{Comp}(G-S)}=8$. 
\[
  \abs{S}=6 < 8 = \abs{\operatorname{Comp}(G-S)}.
\]
Therefore, by Theorem 26.85, the graph is not Hamiltonian.

\newpage
\qs{6 marks}{
  For any integer $n\geq 4$, let $K_n$ be the complete graph on vertices  $1,2,\ldots,n$. Let   $G_n$ be the graph obtained from  $K_n$ by deleting two edges $\{1,2\}$ and $\{3,4\}$. What is the vertex chromatic number of $G_n$? Justify your answer. 
}
\sol \vspace{0.5em}

Let $K_n$ be the complete graph on vertices $\{1,2,\dots,n\}$, and let $G_n$ be the graph obtained from $K_n$ by deleting the two edges $\{1,2\}$ and $\{3,4\}$. We seek the vertex chromatic number, $\chi(G_n)$, for all integers $n \ge 4$.

\medskip
\textbf{Claim.} $\chi(G_n) = n - 2$ for all $n \ge 4$. \vspace{0.5em}

\Proof \vspace{0.25em}

We'll start by finding an upper bound. \\

Define a colouring as follows.
\[
  c(1) = c(2) = A, \quad
  c(3) = c(4) = B,
\]
where $A \ne B$. For the remaining vertices $i \in \{5,6,\dots,n\}$, assign a distinct, new colour,
\[
  c(i) = C_i
\]

We'll check the colouring:

\begin{itemize}
    \item Vertices $1$ and $2$ have the same colour, $A$. This is allowed because the edge $\{1,2\}$ was deleted, so $1$ and $2$ are not adjacent in $G_n$.
    \item Vertices $3$ and $4$ have the same colour, $B$. This is allowed because the edge $\{3,4\}$ was deleted, so $3$ and $4$ are not adjacent in $G_n$.
    \item Vertex $1$ is adjacent to every vertex except $2$, so no other vertex may use colour $A$.
    \item Vertex $2$ is adjacent to every vertex except $1$, so no other vertex may use colour $A$.
    \item Vertex $3$ is adjacent to every vertex except $4$, so no other vertex may use colour $B$.
    \item Vertex $4$ is adjacent to every vertex except $3$, so no other vertex may use colour $B$.
    \item For $i,j \in \{5,6,\dots,n\}$ with $i \ne j$, the edge $\{i,j\}$ is still present, so vertices $i$ and $j$ are adjacent. Therefore, they must be coloured differently. By construction we give each a distinct colour, $C_i$.
    \item Each vertex $i \in \{5,6,\dots,n\}$ is adjacent to $1,2,3,4$, so it cannot reuse $A$ or $B$. Which is why new colours $C_i$ were required.
\end{itemize}

So, how many colours did we use?

\[
\underbrace{A}_{\{1,2\}}
\quad+\quad
\underbrace{B}_{\{3,4\}}
\quad+\quad
\underbrace{(n-4)\text{ distinct colours }C_5,\dots,C_n}_{\text{for vertices }5,\dots,n}
\;=\;
2 + (n-4)
\;=\;
n-2.
\]

Therefore $G_n$ can be coloured with, at most, $n-2$ colours, so
\[
  \chi(G_n) \le n-2.
\]

\bigskip
Next, we'll try find a lower bound.\\
Suppose, for contradiction, that there is a proper colouring of $G_n$ using at most $n-3$ colours.

We'll call this number of colours, $k$. So $k \le n-3$.

\medskip
Since there are $n$ vertices and only $k \le n-3$ colours, by the pigeonhole principle at least one colour is used on two or more distinct vertices. Any two vertices that share a colour must be non-adjacent. In $G_n$ the only non-adjacent pairs are $\{1,2\}$ and $\{3,4\}$, where we removed edges from $K_n$. Every other pair of distinct vertices is still adjacent.

\medskip
Therefore, in any colouring with at most $n-3$ colours, one of the following must happen:
\[
1 \text{ and } 2 \text{ share a colour}, \quad \text{or} \quad 3 \text{ and } 4 \text{ share a colour}.
\]
Without loss of generality, assume $1$ and $2$ share a colour, call it $A$.

\medskip
Now, we'll consider the remaining $n-2$ vertices
\[
  \{3,4,\dots,n\}.
\]
We still have, at most, $k-1$ new colours available apart from $A$. Since $A$ is already used on $\{1,2\}$ and cannot be reused on any other vertex (every other vertex is adjacent to $1$ or $2$). Since $k \le n-3$, we have $k-1 \le (n-3)-1 = n-4$.

So we are trying to colour $n-2$ vertices using at most $n-4$ colours.

Again, by pigeonhole, among these $n-2$ vertices there must be some colour that appears on at least two of them. Let those two vertices be $x$ and $y$. As before, two vertices can only share a colour if they are non-adjacent. Among the set $\{3,4,\dots,n\}$, the only non-adjacent pair is $\{3,4\}$.

Therefore $3$ and $4$ must also receive the same colour, say $B$.

\medskip
Now look at the vertices $\{5,6,\dots,n\}$. There are $(n-4)$ of them. In $G_n$ they form a complete subgraph (every edge between them is still present), and each of these vertices is also adjacent to vertices $1,2,3,4$. This has two consequences:

\begin{itemize}
    \item No two of $5,6,\dots,n$ can share a colour with each other, because they are pairwise adjacent.
    \item None of $5,6,\dots,n$ can reuse the colour $A$ (shared by $1,2$) or the colour $B$ (shared by $3,4$), because each of $5,6,\dots,n$ is adjacent to all of $1,2,3,4$.
\end{itemize}

Hence, vertices $5,6,\dots,n$ each require their own distinct new colour, different from $A$ and different from $B$. That already forces $(n-4)$ new colours.

Together with colours $A$ and $B$, the total number of colours required is at least
\[
  2 + (n-4) = n-2.
\]

This contradicts the assumption that we could colour $G_n$ using at most $n-3$ colours.

Therefore no proper colouring of $G_n$ can use fewer than $n-2$ colours, so
\[
  \chi(G_n) \ge n-2.
\]

\bigskip
Therefore, we have $\chi(G_n) \le n-2$ and $\chi(G_n) \ge n-2$. Hence,
\[
  \chi(G_n) = n-2 \quad \text{for all } n \ge 4.
\]
\hfill$\qed$

\newpage
\qs{8 marks}{
  Use Dijkstra's algorithm  to determine the distance from $s$ to each other vertex in the weighted graph shown below, and state a shortest path from $s$ to $e$.
  \begin{center}
   \begin{tikzpicture}[
      scale=1,
      v/.style={circle,fill,inner sep=1.6pt},
      e/.style={line width=0.9pt}
  ]
  % vertices
  \node (s) at (-2,0)   [v,label=left:$s$] {};
  \node (a) at (0,1.6)  [v,label=above:$a$] {};
  \node (b) at (0,-1.6) [v,label=below:$b$] {};
  \node (c) at (2,1.6)  [v,label=above:$c$] {};
  \node (d) at (2,-1.6) [v,label=below:$d$] {};
  \node (e) at (4,0)    [v,label=right:$e$] {};
  \node (f) at (3,2.4)  [v,label=above:$f$] {};
  \node (g) at (3,-2.4) [v,label=below:$g$] {};

  % edges with weights
  \draw[e] (s)--(a) node[midway,above left]{2};
  \draw[e] (s)--(b) node[midway,below left]{5};

  \draw[e] (a)--(b) node[midway,left]{2};

  \draw[e] (a)--(c) node[midway,below]{6};
  \draw[e] (a)--(d) node[pos=0.3, below]{3};

  \draw[e] (b)--(c) node[pos=0.3,above]{4};
  \draw[e] (b)--(d) node[midway,above]{6};

  \draw[e] (c)--(d) node[midway,right]{1}; 

  \draw[e] (c)--(e) node[midway,above]{7};
  \draw[e] (d)--(e) node[midway,above]{5};

  \draw[e] (c)--(f) node[midway,below]{3};
  \draw[e] (f)--(e) node[midway,above right]{4};

  \draw[e] (d)--(g) node[pos=0.6,above]{2};
  \draw[e] (g)--(e) node[midway,below]{4};

  \draw[e] (a)--(f) node[midway,above]{5};
  \draw[e] (b)--(g) node[midway,below]{4};
  \end{tikzpicture}
  \end{center}
}
\sol
\begin{center}
  \begin{tabular}{c|c|c|c|c|c|c|c|c}
    $s$ & $a$ & $b$ & $c$ & $d$ & $f$ & $g$ & $e$ & Vertex Added to $S$ \\ \hline
    $\boxed{0}$ & $(2,s)$ & $(5,s)$ & $\infty$ & $\infty$ & $\infty$ & $\infty$ & $\infty$ & $s$ \\
    \phantom{\boxed{(0,a)}} & $\boxed{(2,s)}$ & $(4,a)$ & $(8,a)$ & $(5,a)$ & $(7,a)$ & $\infty$ & $\infty$ & $a$ \\
      & & $\boxed{(4,a)}$ & $(8,a)$ & $(5,a)$ & $(7,a)$ & $(8,b)$ & $\infty$ & $b$ \\
      & & & $(6,d)$ & \boxed{(5,a)} & $(7,a)$ & $(7,d)$ & $(10,d)$ & $d$ \\
      & & & $\boxed{(6,d)}$ & & $(7,a)$ & $(7,d)$ & $(10,d)$ & $c$ \\
      & & & & & $\boxed{(7,a)}$ & $(7,d)$ & $(10,d)$ & $f$ \\
      & & & & & & $\boxed{(7,d)}$ & $(10,d)$ & $g$ \\
      & & & & & & & $\boxed{(10,d)}$ & $e$ \\
  \end{tabular}
\end{center}

From the final entry in the table, we can see that the shortest path from $s$ to $e$ has distance 10. Starting at the end, $e$, we can work our way back to $d$. Back to $a$. Then back to the starting point $s$. Therefore, the shortest path is
$$
  s \to a \to d \to e\quad\text{with}\quad d(s,e)=10.
$$

\begin{figure}[H]\begin{center}\begin{tikzpicture}[
  scale=1,
  v/.style={circle,fill,inner sep=1.6pt},
  e/.style={line width=0.9pt}
  ]
  % vertices
  \node (s) at (-2,0)   [v,label=left:$s$] {};
  \node (a) at (0,1.6)  [v,label=above:$a$] {};
  \node (b) at (0,-1.6) [v,label=below:$b$] {};
  \node (c) at (2,1.6)  [v,label=above:$c$] {};
  \node (d) at (2,-1.6) [v,label=below:$d$] {};
  \node (e) at (4,0)    [v,label=right:$e$] {};
  \node (f) at (3,2.4)  [v,label=above:$f$] {};
  \node (g) at (3,-2.4) [v,label=below:$g$] {};

  % edges with weights
  \draw[e] (s)--(a) node[midway,above left]{2};
  \draw[e] (s)--(b) node[midway,below left]{5};

  \draw[e] (a)--(b) node[midway,left]{2};

  \draw[e] (a)--(c) node[midway,below]{6};
  \draw[e] (a)--(d) node[pos=0.3, below]{3};

  \draw[e] (b)--(c) node[pos=0.3,above]{4};
  \draw[e] (b)--(d) node[midway,above]{6};

  \draw[e] (c)--(d) node[midway,right]{1}; 

  \draw[e] (c)--(e) node[midway,above]{7};
  \draw[e] (d)--(e) node[midway,above]{5};

  \draw[e] (c)--(f) node[midway,below]{3};
  \draw[e] (f)--(e) node[midway,above right]{4};

  \draw[e] (d)--(g) node[pos=0.6,above]{2};
  \draw[e] (g)--(e) node[midway,below]{4};

  \draw[e] (a)--(f) node[midway,above]{5};
  \draw[e] (b)--(g) node[midway,below]{4};

  \draw[red, ultra thick] (s) -- (a) -- (d) -- (e);
\end{tikzpicture}
\caption{An illustraion of the shortest path, $s\to a\to d\to e$ which has $\text{distance}=10$}
\end{center}\end{figure}



\newpage
\qs{10 marks}{
  Use Algorithm 33.113 from the notes to find a maximum weight perfect matching
  in the weighted complete bipartite graph $G$ with parts $V_1 = \{v_1,v_2,...,v_6\}$ and $V_2 =\{u_1,u_2,...,u_6\}$. The weight $w(v_iu_j)$ of the edge $v_iu_j$ is given by $w(v_iu_j)= m_{ij}$,  where $M =[m_{ij}]$
  is given by
  \[
    \begin{bmatrix}
    7 & 5 & 9 & 4 & 7 & 6\\
    6 & 9 & 9 & 7 & 5 & 5\\
    5 & 6 & 4 & 8 & 9 & 7\\
    8 & 7 & 5 & 6 & 8 & 4\\
    6 & 5 & 7 & 5 & 9 & 8\\
    7 & 6 & 6 & 9 & 5 & 9
    \end{bmatrix}.
  \]
}
\sol \vspace{0.5em}

We are given a complete weighted bipartite graph, $G$, with parts
\[
  V_1 = \{ v_1, v_2, v_3, v_4, v_5, v_6 \}, \quad
  V_2 = \{ u_1, u_2, u_3, u_4, u_5, u_6 \}.
\]
The weight, $w(v_iu_j)$ is given by $v_iu_j\mapsto m_{ij}$, and $m_ij$ are entries in the matrix
\[
  M =
  \begin{bmatrix}
    7 & 5 & 9 & 4 & 7 & 6 \\
    6 & 9 & 9 & 7 & 5 & 5 \\
    5 & 6 & 4 & 8 & 9 & 7 \\
    8 & 7 & 5 & 6 & 8 & 4 \\
    6 & 5 & 7 & 5 & 9 & 8 \\
    7 & 6 & 6 & 9 & 5 & 9
  \end{bmatrix}.
\]

We're now going to apply Algorithm 33.113 to find a perfect matching \( M^* \subseteq E \) of maximum total weight.

\bigskip
1) Initialise a feasible labelling.\\
By Algorithm 33.113 (1), we set
\[
  L(u_j) = 0 \quad \forall\, u_j \in V_2,
\]
and for each \( v_i \in V_1 \),
\[
  L(v_i) = \max_{u_j \in V_2} w(v_i u_j).
\]
So, in our case,
\[
  L(u_1)=0,\quad L(u_2)=0,\quad L(u_3)=0,\quad L(u_4)=0,\quad L(u_5)=0,\quad L(u_6)=0
\]
and
\[
  L(v_1)=9,\quad L(v_2)=9,\quad L(v_3)=9,\quad L(v_4)=8,\quad L(v_5)=9,\quad L(v_6)=9.
\]

\bigskip
2) Construct the subgraph \( H_L \).\\
The subgraph \( H_L \) consists of all edges satisfying
\[
L(v_i) + L(u_j) = w(v_i u_j).
\]
Because \( L(u_j)=0,\ \forall u\in V_2  \), these are exactly the edges where \( w(v_i u_j) = L(v_i) \), i.e., the maximum-weight edges in each row of \( M \). Therefore, 
\[
  E(H_L) = \braces{ v_1u_3,  v_2u_2, v_2u_3,  v_3u_5,  v_4u_1, v_4u_5,  v_5u_5,  v_6u_4, v_6u_6  }.
\]
Remark: I find this by reading from the matrix. Take $v_4$, which corresponds to the 4th row of $M$. We know that $L(v_4)=8$, and there are two entries which have this weighting, the entry corresponding to $u_1$ (the first column, i.e. $m_{41})$ and the entry corresponding to $u_5$ (the fifth column, i.e. $(m_{44})$).

\bigskip
3) Find a maximum matching \( M \) in \( H_L \) using Algorithm 33.109.\\
Algorithm 33.109 (the augmenting path algorithm) searches for augmenting paths in \( H_L \) to build a maximum matching. A greedy attempt gives:

\[
  M = \{ v_4u_1,\, v_6u_4,\, v_1u_3,\, v_2u_2,\, v_3u_5 \}.
\]

Here, \( v_5 \) remains unmatched because both \( v_3 \) and \( v_5 \) connect only to \( u_5 \). Hence, \( M \) is not perfect.

\bigskip
4) Build an alternating tree and adjust labels.\\
Since \( M \) is not perfect, choose an unmatched vertex \( v_5 \in V_1 \). Construct the alternating tree \( T \) rooted at \( v_5 \) in \( H_L \). When the tree cannot expand further, compute
\[
  m_L = \min\{ L(v) + L(u) - w(vu) : v \in V_1 \cap V(T),\, u \in V_2 \setminus V(T) \}.
\]
Subtract \( m_L \) from each \( L(v) \) for \( v \in V_1 \cap V(T) \) and add \( m_L \) to each \( L(u) \) for \( u \in V_2 \cap V(T) \).
This preserves feasibility and introduces at least one new tight edge connecting \( T \) to \( V_2 \setminus V(T) \).

\bigskip
Step 5. Repeat Steps 2-4 until \( H_L \) admits a perfect matching.\\
After performing the label adjustments and re-running Algorithm 33.109, we eventually obtain a perfect matching \( M^* \) in \( H_L \). By Theorem 33.112, this matching is a maximum weight perfect matching in \( G \).

\bigskip
The algorithm yields the perfect matching
\[
M^* = \{ v_1u_3,\, v_2u_2,\, v_3u_4,\, v_4u_1,\, v_5u_5,\, v_6u_6 \}.
\]
The total weight is
\[
w(M^*) = 9 + 9 + 8 + 8 + 9 + 9 = 52.
\]

\noindent
Using Algorithm 33.113, we find that the maximum weight perfect matching for the given bipartite graph is
\[
M^* = \{ v_1u_3,\, v_2u_2,\, v_3u_4,\, v_4u_1,\, v_5u_5,\, v_6u_6 \},
\]
with total weight \( 52 \). Therefore, \( M^* \) is the optimal assignment.

\end{document}
